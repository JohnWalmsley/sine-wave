% This script generates latex format tables for the publication,
% directly from the matlab processed results.
close all
clear all

models = {'New model for Cell \\#4','\\citet{wang1997}','\\citet{diveroli2013}','\\citet{mazhari2001}','\\citet{tentusscher2004}','\\citet{zeng1995}'};

fits = [
0.0346 0.0649 0.0931 0.1337 0.0864;
0.0962 0.0624 0.0804 0.0736 0.0928;
0.0713 0.0871 0.1381 0.1462 0.1028;
0.0744 0.0992 0.1098 0.1828 0.1249;
0.1374 0.1350 0.1268 0.1771 0.1663;
0.1545 0.1867 0.1939 0.2194 0.1713];

% Scalings to use in the colouring
% 0 = 0
% largest error = 100
column_scalings = max(fits);

assert(size(fits,1)==length(models))

% Make a colormap of 100 colours
colours = colormap(autumn(101));

high = colours(1,:);
low = colours(end,:);

% Print out LaTeX code for the table to screen
fprintf('%% This table was auto-generated by table_D2/results_to_latex_tables.m, so don''t edit it here, edit that instead!\n')
fprintf('\\begin{table}[htb]\n')
fprintf('\\begin{center}\n')
fprintf('\\caption{Table quantifying square root of mean square difference (units nA) between experimental\n')
fprintf('current traces and simulation predictions for the validation protocols shown\n')
fprintf('in Figures~\\ref{fig:traditional_protocols} and \\ref{fig:ap_protocol}.\n')
fprintf('Here the colour scale is set so that \\colorbox[rgb]{%g,%g,%g}{\\textcolor[rgb]{%g,%g,%g}{T}} represents zero error\n',low(1),low(2),low(3),low(1),low(2),low(3))
fprintf('and \\colorbox[rgb]{%g,%g,%g}{\\textcolor[rgb]{%g,%g,%g}{T}} represents the highest error for each protocol/column.}\n',high(1),high(2),high(3),high(1),high(2),high(3))
fprintf('\\begin{small}\n')
fprintf('\\begin{tabular}{l*{5}{c}}\\cline{2-6}\n')
fprintf('\\toprule\n')
fprintf('Model & Sine Wave (Pr7) & AP (Pr6) & Steady Act. (Pr3) &  Deact. (Pr4) &  Inact. (Pr5) \\\\ \n')
fprintf('\\midrule\n')
for i=1:size(fits,1)
    fprintf([models{i} ])
    for j = 1:size(fits,2)
        scaled_data = 100.0.*(1.0 - fits(i,j)./column_scalings(j));
        rgb1=colours(floor(scaled_data)+1,:);
        fprintf(' & \\cellcolor[rgb]{%f,%f,%f} %5.4f',rgb1(1),rgb1(2),rgb1(3),fits(i,j))
    end
    fprintf('\\\\\n')
end
fprintf('\\bottomrule\n')
fprintf('\\end{tabular}\n')
fprintf('\\label{tab:quantifying_predictions}\n')
fprintf('\\end{small}\n')
fprintf('\\end{center}\n')
fprintf('\\end{table}\n')


